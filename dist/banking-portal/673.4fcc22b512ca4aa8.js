"use strict";(self.webpackChunkbanking_portal=self.webpackChunkbanking_portal||[]).push([[673],{6673:(S,w,p)=>{p.r(w),p.d(w,{ClientsPageComponent:()=>k});var _=p(467),f=p(9544),n=p(4358),h=p(2425),E=p(8219),y=p(1573),v=p(5417),x=function(a){return a.MALE="M",a.FEMALE="F",a.OTHER="O",a}(x||{});const d={[x.MALE]:"Masculino",[x.FEMALE]:"Femenino",[x.OTHER]:"Otro"};var e=p(3862),g=p(9999),C=p(5567);function P(a,u){1&a&&(e.\u0275\u0275elementStart(0,"div",36),e.\u0275\u0275text(1," \u26a0\ufe0f Este nombre de cliente ya est\xe1 registrado en el sistema. Por favor use otro nombre. "),e.\u0275\u0275elementEnd())}function M(a,u){1&a&&(e.\u0275\u0275elementStart(0,"div",36),e.\u0275\u0275text(1," \u26a0\ufe0f Esta identificaci\xf3n ya est\xe1 registrada en el sistema. Por favor use otra identificaci\xf3n. "),e.\u0275\u0275elementEnd())}function b(a,u){if(1&a&&(e.\u0275\u0275elementStart(0,"option",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const c=u.$implicit;e.\u0275\u0275property("value",c.value),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",c.label," ")}}function F(a,u){if(1&a&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const c=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",c.getFieldError("gender")," ")}}function V(a,u){if(1&a&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const c=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",c.getFieldError("status")," ")}}function O(a,u){if(1&a&&e.\u0275\u0275element(0,"app-input",39),2&a){const c=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("required",!c.isEditing)("errorMessage",c.getFieldError("password"))}}function T(a,u){if(1&a&&e.\u0275\u0275element(0,"app-input",40),2&a){const c=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("required",!c.isEditing)("errorMessage",c.getFieldError("confirmPassword"))}}function I(a,u){if(1&a&&(e.\u0275\u0275elementStart(0,"div",19)(1,"label",20),e.\u0275\u0275text(2,"Cambio de contrase\xf1a (opcional)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"app-input",41)(4,"app-input",42)(5,"app-input",43),e.\u0275\u0275elementEnd()),2&a){const c=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("required",!1)("errorMessage",c.getFieldError("currentPassword")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!1)("errorMessage",c.getFieldError("newPassword")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!1)("errorMessage",c.getFieldError("confirmNewPassword"))}}function N(a,u){if(1&a){const c=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(c);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(t.closeModal())}),e.\u0275\u0275elementStart(1,"div",10),e.\u0275\u0275listener("click",function(t){return e.\u0275\u0275restoreView(c),e.\u0275\u0275resetView(t.stopPropagation())}),e.\u0275\u0275elementStart(2,"div",11)(3,"h2",12),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(c);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(t.closeModal())}),e.\u0275\u0275text(6,"\xd7"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"form",14),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(c);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(t.onSubmit())}),e.\u0275\u0275elementStart(8,"div",15),e.\u0275\u0275element(9,"app-input",16),e.\u0275\u0275template(10,P,2,0,"div",17),e.\u0275\u0275element(11,"app-input",18),e.\u0275\u0275template(12,M,2,0,"div",17),e.\u0275\u0275elementStart(13,"div",19)(14,"label",20),e.\u0275\u0275text(15,"G\xe9nero"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"select",21)(17,"option",22),e.\u0275\u0275text(18,"Seleccionar g\xe9nero"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,b,2,2,"option",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(20,F,2,1,"div",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",19)(22,"label",20),e.\u0275\u0275text(23,"Estado"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"select",25)(25,"option",26),e.\u0275\u0275text(26,"Activo (S\xed)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"option",26),e.\u0275\u0275text(28,"Inactivo (No)"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(29,V,2,1,"div",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(30,"app-input",27)(31,"app-input",28)(32,"app-input",29),e.\u0275\u0275template(33,O,1,2,"app-input",30)(34,T,1,2,"app-input",31)(35,I,6,6,"div",32),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"div",33)(37,"app-button",34),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(c);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(t.closeModal())}),e.\u0275\u0275text(38," Cancelar "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"app-button",35),e.\u0275\u0275text(40),e.\u0275\u0275elementEnd()()()()()}if(2&a){let c,r;const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",t.isEditing?"Editar Cliente":"Nuevo Cliente"," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.clientForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("name")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==(c=t.clientForm.get("name"))?null:c.hasError("nameTaken")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("identification")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==(r=t.clientForm.get("identification"))?null:r.hasError("identificationTaken")),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",t.genderOptions),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",t.getFieldError("gender")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngValue",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngValue",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.getFieldError("status")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("age")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("address")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("phone")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!t.isEditing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!t.isEditing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",t.isEditing),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",t.clientForm.invalid||t.clientForm.pending||t.loading),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",t.isEditing?"Actualizar":"Crear"," ")}}let k=(()=>{var a;class u{constructor(r,t,o){this.clientService=r,this.notificationService=t,this.fb=o,this.clients=[],this.filteredClients=[],this.searchTerm="",this.showModal=!1,this.isEditing=!1,this.loading=!1,this.currentClient=null,this.pageSize=10,this.totalItems=0,this.tableColumns=[{key:"name",label:"Nombre",sortable:!0},{key:"identification",label:"Identificaci\xf3n",sortable:!0},{key:"gender",label:"G\xe9nero",sortable:!0},{key:"age",label:"Edad",sortable:!0,type:"number"},{key:"phone",label:"Tel\xe9fono",sortable:!0},{key:"status",label:"Estado",sortable:!0,type:"boolean"}],this.tableActions=[{label:"Editar",action:"edit",variant:"primary"},{label:"Eliminar",action:"delete",variant:"danger"}],this.genderOptions=Object.entries(d).map(([s,i])=>({value:s,label:i})),this.destroy$=new h.Subject,this.clientForm=this.createForm()}ngOnInit(){this.loadClients(),this.setupSearch()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}createForm(){return this.fb.group({name:["",[n.Validators.required,n.Validators.minLength(2)],[this.uniqueNameValidator()]],identification:["",[n.Validators.required,n.Validators.pattern(/^\d+$/)],[this.uniqueIdentificationValidator()]],gender:["",n.Validators.required],age:["",[n.Validators.required,n.Validators.min(1),n.Validators.max(120)]],address:["",[n.Validators.required,n.Validators.minLength(5)]],phone:["",[n.Validators.required,n.Validators.pattern(/^\d{10}$/)]],password:["",[n.Validators.required,n.Validators.minLength(4)]],confirmPassword:["",[n.Validators.required,n.Validators.minLength(4)]],currentPassword:[""],newPassword:[""],confirmNewPassword:[""],status:[!0,n.Validators.required]},{validators:[this.passwordsMatchValidator()]})}setupSearch(){}loadClients(){this.loading=!0,this.clientService.getClients().pipe((0,h.takeUntil)(this.destroy$)).subscribe({next:r=>{this.clients=r,this.filteredClients=r,this.totalItems=r.length,this.loading=!1},error:r=>{console.error("Error cargando clientes:",r),this.notificationService.showError("Error","No se pudieron cargar los clientes: "+r.message),this.loading=!1}})}onSearchChange(r){this.searchTerm=r.target.value,this.filterClients()}filterClients(){if(!this.searchTerm||""===this.searchTerm.trim())return void(this.filteredClients=this.clients);const r=this.searchTerm.toLowerCase();this.filteredClients=this.clients.filter(t=>t.name.toLowerCase().includes(r)||t.identification.includes(r)||t.phone.includes(r)||t.address.toLowerCase().includes(r))}openCreateModal(){this.isEditing=!1,this.currentClient=null,this.clientForm.reset(),this.clientForm.get("password")?.setValidators([n.Validators.required,n.Validators.minLength(4)]),this.clientForm.get("confirmPassword")?.setValidators([n.Validators.required,n.Validators.minLength(4)]),this.clientForm.get("password")?.updateValueAndValidity(),this.clientForm.get("confirmPassword")?.updateValueAndValidity(),this.clientForm.get("status")?.setValue(!0),this.showModal=!0}openEditModal(r){this.isEditing=!0,this.currentClient=r,this.clientForm.patchValue({name:r.name,identification:r.identification,gender:r.gender,age:r.age,address:r.address,phone:r.phone,status:r.status}),this.clientForm.get("password")?.clearValidators(),this.clientForm.get("confirmPassword")?.clearValidators(),this.clientForm.get("password")?.setValue(""),this.clientForm.get("confirmPassword")?.setValue(""),this.clientForm.get("password")?.addValidators([n.Validators.minLength(4)]),this.clientForm.get("confirmPassword")?.addValidators([n.Validators.minLength(4)]),this.clientForm.get("currentPassword")?.setValue(""),this.clientForm.get("newPassword")?.setValue(""),this.clientForm.get("confirmNewPassword")?.setValue(""),this.clientForm.get("newPassword")?.addValidators([n.Validators.minLength(4)]),this.clientForm.get("confirmNewPassword")?.addValidators([n.Validators.minLength(4)]),this.clientForm.get("password")?.updateValueAndValidity(),this.clientForm.get("confirmPassword")?.updateValueAndValidity(),this.clientForm.get("newPassword")?.updateValueAndValidity(),this.clientForm.get("confirmNewPassword")?.updateValueAndValidity(),this.showModal=!0}closeModal(){this.showModal=!1,this.isEditing=!1,this.currentClient=null,this.clientForm.reset()}onSubmit(){var r=this;return(0,_.A)(function*(){if(r.clientForm.valid){r.loading=!0;const t=r.clientForm.value;if(r.isEditing&&r.currentClient){const o={name:t.name,identification:t.identification,gender:t.gender,age:t.age,address:t.address,phone:t.phone,status:!0===t.status};if(t.password&&(o.password=t.password),t.currentPassword||t.newPassword||t.confirmNewPassword){if(!t.currentPassword||!t.newPassword||t.newPassword!==t.confirmNewPassword)return r.notificationService.showError("Error","Complete y confirme correctamente la nueva contrase\xf1a"),void(r.loading=!1);if(r.currentClient?.password)try{if((yield r.hashSha256Hex(t.currentPassword))!==r.currentClient.password)return r.notificationService.showError("Error","La contrase\xf1a actual es incorrecta"),void(r.loading=!1)}catch{return r.notificationService.showError("Error","No se pudo validar la contrase\xf1a actual"),void(r.loading=!1)}o.password=t.newPassword}r.clientService.updateClient(r.currentClient.clientId,o).pipe((0,h.takeUntil)(r.destroy$)).subscribe({next:()=>{r.notificationService.showSuccess("\xc9xito","Cliente actualizado correctamente"),r.closeModal(),r.loadClients()},error:i=>{console.error("Error al actualizar cliente:",i);let l="No se pudo actualizar el cliente";if(i.error?.message||i.message){const m=(i.error?.message||i.message).toLowerCase();m.includes("nombre")&&(m.includes("ya existe")||m.includes("duplicate")||m.includes("already exists"))?l=`El nombre "${t.name}" ya est\xe1 registrado. Por favor use otro nombre.`:m.includes("identificaci\xf3n")||m.includes("identification")?(m.includes("ya existe")||m.includes("duplicate")||m.includes("already exists"))&&(l=`La identificaci\xf3n "${t.identification}" ya est\xe1 registrada. Por favor use otra identificaci\xf3n.`):409===i.status&&(l="El cliente ya existe con esos datos. Por favor use otros valores.")}r.notificationService.showError("Error",l),r.loading=!1}})}else r.clientService.createClient({name:t.name,identification:t.identification,gender:t.gender,age:t.age,address:t.address,phone:t.phone,password:t.password,status:!0===t.status}).pipe((0,h.takeUntil)(r.destroy$)).subscribe({next:()=>{r.notificationService.showSuccess("\xc9xito","Cliente creado correctamente"),r.closeModal(),r.loadClients()},error:s=>{console.error("Error al crear cliente:",s);let i="No se pudo crear el cliente";if(s.error?.message||s.message){const l=(s.error?.message||s.message).toLowerCase();l.includes("nombre")&&(l.includes("ya existe")||l.includes("duplicate")||l.includes("already exists"))?i=`El nombre "${t.name}" ya est\xe1 registrado. Por favor use otro nombre.`:l.includes("identificaci\xf3n")||l.includes("identification")?(l.includes("ya existe")||l.includes("duplicate")||l.includes("already exists"))&&(i=`La identificaci\xf3n "${t.identification}" ya est\xe1 registrada. Por favor use otra identificaci\xf3n.`):409===s.status&&(i="El cliente ya existe con esos datos. Por favor use otros valores.")}r.notificationService.showError("Error",i),r.loading=!1}})}})()}onTableAction(r){switch(r.action){case"edit":this.openEditModal(r.row);break;case"delete":this.deleteClient(r.row)}}deleteClient(r){confirm(`\xbfEst\xe1 seguro de que desea eliminar al cliente ${r.name}?`)&&(this.loading=!0,this.clientService.deleteClient(r.clientId).pipe((0,h.takeUntil)(this.destroy$)).subscribe({next:()=>{this.notificationService.showSuccess("\xc9xito","Cliente eliminado correctamente"),this.loadClients()},error:t=>{this.notificationService.showError("Error","No se pudo eliminar el cliente"),this.loading=!1}}))}onSortChange(r){}getFieldError(r){const t=this.clientForm.get(r);if(t?.errors&&t.touched){if(t.errors.required)return"Este campo es requerido";if(t.errors.minlength)return`M\xednimo ${t.errors.minlength.requiredLength} caracteres`;if(t.errors.pattern)return"Formato inv\xe1lido";if(t.errors.min)return`Valor m\xednimo: ${t.errors.min.min}`;if(t.errors.max)return`Valor m\xe1ximo: ${t.errors.max.max}`;if(t.errors.passwordMismatch)return"Las contrase\xf1as no coinciden";if(t.errors.nameTaken)return"Este nombre ya est\xe1 registrado";if(t.errors.identificationTaken)return"Esta identificaci\xf3n ya est\xe1 registrada"}return""}passwordsMatchValidator(){return r=>{const t=r.get("password")?.value,o=r.get("confirmPassword")?.value;if(this.isEditing||!t&&!o)return null;if(t!==o){const s=r.get("confirmPassword"),i=s?.errors||{};return s?.setErrors({...i,passwordMismatch:!0}),{passwordMismatch:!0}}{const s=r.get("confirmPassword");if(s?.errors&&s.errors.passwordMismatch){const{passwordMismatch:i,...l}=s.errors;s.setErrors(Object.keys(l).length?l:null)}return null}}}hashSha256Hex(r){return(0,_.A)(function*(){const o=(new TextEncoder).encode(r),s=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("")})()}uniqueNameValidator(){return r=>{const t=r.value;if(!t||t.trim().length<2)return Promise.resolve(null);const o=this.isEditing&&this.currentClient?this.currentClient.clientId:void 0,s=this.clients.some(i=>{const l=i.clientId;return i.name.toLowerCase().trim()===t.toLowerCase().trim()&&l!==o});return s?Promise.resolve({nameTaken:!0}):this.clientService.checkNameExists(t,o).pipe(i=>new Promise(l=>{i.subscribe({next:m=>{l(m?{nameTaken:!0}:null)},error:()=>{l(s?{nameTaken:!0}:null)}})}))}}uniqueIdentificationValidator(){return r=>{const t=r.value;if(!t||!/^\d+$/.test(t))return Promise.resolve(null);const o=this.isEditing&&this.currentClient?this.currentClient.clientId:void 0,s=this.clients.some(i=>i.identification===t&&i.clientId!==o);return s?Promise.resolve({identificationTaken:!0}):this.clientService.checkIdentificationExists(t,o).pipe(i=>new Promise(l=>{i.subscribe({next:m=>{l(m?{identificationTaken:!0}:null)},error:()=>{l(s?{identificationTaken:!0}:null)}})}))}}static#e=a=()=>(this.\u0275fac=function(t){return new(t||u)(e.\u0275\u0275directiveInject(g.X),e.\u0275\u0275directiveInject(C.J),e.\u0275\u0275directiveInject(n.FormBuilder))},this.\u0275cmp=e.\u0275\u0275defineComponent({type:u,selectors:[["app-clients-page"]],decls:11,vars:7,consts:[[1,"clients-page"],[1,"page-header"],[1,"page-title"],[1,"page-actions"],["type","primary",3,"clicked"],[1,"search-section"],["placeholder","Buscar",3,"ngModelChange","input","ngModel"],[3,"actionClick","sortChange","data","columns","actions","showPagination","pageSize"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-close",3,"click"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"form-grid"],["label","Nombre","formControlName","name",3,"required","errorMessage"],["class","duplicate-warning",4,"ngIf"],["label","Identificaci\xf3n","formControlName","identification",3,"required","errorMessage"],[1,"form-group"],[1,"form-label"],["formControlName","gender",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","error-message",4,"ngIf"],["formControlName","status",1,"form-select"],[3,"ngValue"],["label","Edad","type","number","formControlName","age",3,"required","errorMessage"],["label","Direcci\xf3n","formControlName","address",3,"required","errorMessage"],["label","Tel\xe9fono","type","tel","formControlName","phone",3,"required","errorMessage"],["label","Contrase\xf1a","type","password","formControlName","password",3,"required","errorMessage",4,"ngIf"],["label","Repetir contrase\xf1a","type","password","formControlName","confirmPassword",3,"required","errorMessage",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"modal-footer"],["htmlType","button","type","secondary",3,"clicked"],["htmlType","submit","type","primary",3,"disabled"],[1,"duplicate-warning"],[3,"value"],[1,"error-message"],["label","Contrase\xf1a","type","password","formControlName","password",3,"required","errorMessage"],["label","Repetir contrase\xf1a","type","password","formControlName","confirmPassword",3,"required","errorMessage"],["label","Contrase\xf1a actual","type","password","formControlName","currentPassword",3,"required","errorMessage"],["label","Nueva contrase\xf1a","type","password","formControlName","newPassword",3,"required","errorMessage"],["label","Repetir nueva contrase\xf1a","type","password","formControlName","confirmNewPassword",3,"required","errorMessage"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"h1",2),e.\u0275\u0275text(3,"Clientes"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",3)(5,"app-button",4),e.\u0275\u0275listener("clicked",function(){return o.openCreateModal()}),e.\u0275\u0275text(6," Nuevo "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"div",5)(8,"app-input",6),e.\u0275\u0275twoWayListener("ngModelChange",function(i){return e.\u0275\u0275twoWayBindingSet(o.searchTerm,i)||(o.searchTerm=i),i}),e.\u0275\u0275listener("input",function(i){return o.onSearchChange(i)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"app-table",7),e.\u0275\u0275listener("actionClick",function(i){return o.onTableAction(i)})("sortChange",function(i){return o.onSortChange(i)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,N,41,24,"div",8),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(8),e.\u0275\u0275twoWayProperty("ngModel",o.searchTerm),e.\u0275\u0275advance(),e.\u0275\u0275property("data",o.filteredClients)("columns",o.tableColumns)("actions",o.tableActions)("showPagination",!0)("pageSize",o.pageSize),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",o.showModal))},dependencies:[f.CommonModule,f.NgForOf,f.NgIf,n.ReactiveFormsModule,n.\u0275NgNoValidate,n.NgSelectOption,n.\u0275NgSelectMultipleOption,n.SelectControlValueAccessor,n.NgControlStatus,n.NgControlStatusGroup,n.RequiredValidator,n.FormGroupDirective,n.FormControlName,n.FormsModule,n.NgModel,E.Q,y.S,v.O],styles:['@charset "UTF-8";.clients-page[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:var(--spacing-6)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-6);padding-bottom:var(--spacing-4);border-bottom:1px solid var(--gray-200)}.page-title[_ngcontent-%COMP%]{font-size:var(--font-size-3xl);font-weight:600;color:var(--gray-800);margin:0}.page-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-3)}.search-section[_ngcontent-%COMP%]{margin-bottom:var(--spacing-6);max-width:400px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:var(--spacing-4)}.modal-content[_ngcontent-%COMP%]{background-color:var(--white);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-lg);width:100%;max-width:600px;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-6);border-bottom:1px solid var(--gray-200)}.modal-title[_ngcontent-%COMP%]{font-size:var(--font-size-xl);font-weight:600;color:var(--gray-800);margin:0}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:var(--font-size-2xl);color:var(--gray-500);cursor:pointer;padding:var(--spacing-2);line-height:1;transition:color .2s ease}.modal-close[_ngcontent-%COMP%]:hover{color:var(--gray-700)}.modal-body[_ngcontent-%COMP%]{padding:var(--spacing-6)}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:var(--spacing-3);padding:var(--spacing-6);border-top:1px solid var(--gray-200);background-color:var(--gray-50)}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:var(--spacing-4)}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-2)}.form-label[_ngcontent-%COMP%]{font-size:var(--font-size-sm);font-weight:500;color:var(--gray-700)}.form-select[_ngcontent-%COMP%]{padding:var(--spacing-3) var(--spacing-4);border:1px solid var(--gray-300);border-radius:var(--border-radius-md);background-color:var(--white);color:var(--gray-800);font-family:var(--font-family);font-size:var(--font-size-base);transition:all .2s ease;outline:none}.form-select[_ngcontent-%COMP%]:focus{border-color:var(--primary-color);box-shadow:0 0 0 2px #3b82f61a}.form-select[_ngcontent-%COMP%]:invalid{color:var(--gray-400)}.error-message[_ngcontent-%COMP%]{font-size:var(--font-size-xs);color:var(--error-color);margin-top:var(--spacing-1)}.duplicate-warning[_ngcontent-%COMP%]{grid-column:1/-1;background-color:#ef44441a;border:1px solid var(--error-color);border-left:4px solid var(--error-color);color:var(--error-color);padding:var(--spacing-3);border-radius:var(--border-radius-md);font-size:var(--font-size-sm);font-weight:600;margin-top:calc(var(--spacing-2) * -1);margin-bottom:var(--spacing-3);text-align:center}@media (max-width: 768px){.clients-page[_ngcontent-%COMP%]{padding:var(--spacing-4)}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:var(--spacing-4);align-items:stretch}.page-actions[_ngcontent-%COMP%]{justify-content:center}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-content[_ngcontent-%COMP%]{margin:var(--spacing-4);max-height:calc(100vh - 2rem)}.modal-header[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{padding:var(--spacing-4)}.modal-footer[_ngcontent-%COMP%]{flex-direction:column}}@media (max-width: 480px){.clients-page[_ngcontent-%COMP%]{padding:var(--spacing-3)}.page-title[_ngcontent-%COMP%]{font-size:var(--font-size-2xl)}.modal-content[_ngcontent-%COMP%]{margin:var(--spacing-2);max-height:calc(100vh - 1rem)}}']}))}return a(),u})()},9999:(S,w,p)=>{p.d(w,{X:()=>E});var _=p(467),f=p(2425),n=p(3862),h=p(3464);let E=(()=>{var y;class v{constructor(d){this.apiService=d,this.endpoint="/clients"}getClients(d,e){return this.apiService.get(this.endpoint)}getClientById(d){return this.apiService.get(`${this.endpoint}/${d}`)}getClientByIdentification(d){return this.apiService.get(`${this.endpoint}/identification/${d}`)}searchClientsByName(d,e){return this.apiService.getPaginated(`${this.endpoint}/search`,e,{name:d})}createClient(d){return(0,f.from)(this.hashSha256Hex(d.password)).pipe((0,f.switchMap)(e=>{const g={...d,password:e};return this.apiService.post(this.endpoint,g)}))}updateClient(d,e){const g={...e};return e.password?(0,f.from)(this.hashSha256Hex(e.password)).pipe((0,f.switchMap)(C=>(g.password=C,this.apiService.put(`${this.endpoint}/${d}`,g)))):this.apiService.put(`${this.endpoint}/${d}`,g)}updateClientStatus(d,e){return this.apiService.patch(`${this.endpoint}/${d}/status`,{status:e})}deleteClient(d){return this.apiService.delete(`${this.endpoint}/${d}`)}checkIdentificationExists(d,e){const g=e?{excludeId:e.toString()}:{};return this.apiService.get(`${this.endpoint}/check-identification/${d}`,g)}checkNameExists(d,e){const g=e?{excludeId:e.toString()}:{};return this.apiService.get(`${this.endpoint}/check-name/${d}`,g)}getClientStats(){return this.apiService.get(`${this.endpoint}/stats`)}hashSha256Hex(d){return(0,_.A)(function*(){const g=(new TextEncoder).encode(d),C=yield crypto.subtle.digest("SHA-256",g);return Array.from(new Uint8Array(C)).map(b=>b.toString(16).padStart(2,"0")).join("")})()}static#e=y=()=>(this.\u0275fac=function(e){return new(e||v)(n.\u0275\u0275inject(h.G))},this.\u0275prov=n.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"}))}return y(),v})()}}]);