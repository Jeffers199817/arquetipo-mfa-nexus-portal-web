"use strict";(self.webpackChunkbanking_portal=self.webpackChunkbanking_portal||[]).push([[769],{2021:(P,y,c)=>{c.d(y,{w:()=>m});var n=c(3862),s=c(9544),g=c(4358);function x(r,e){if(1&r&&(n.\u0275\u0275elementStart(0,"div",10),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),2&r){const d=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275advance(),n.\u0275\u0275textInterpolate(d.secondaryLabel)}}function b(r,e){if(1&r){const d=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",7),n.\u0275\u0275listener("mousedown",function(){const _=n.\u0275\u0275restoreView(d).$implicit,p=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(p.selectOption(_))}),n.\u0275\u0275elementStart(1,"div",8),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(3,x,2,1,"div",9),n.\u0275\u0275elementEnd()}if(2&r){const d=e.$implicit,l=n.\u0275\u0275nextContext(2);n.\u0275\u0275classProp("selected",d.value===l.selectedValue),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(d.label),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",d.secondaryLabel)}}function E(r,e){if(1&r&&(n.\u0275\u0275elementStart(0,"div",5),n.\u0275\u0275template(1,b,4,4,"div",6),n.\u0275\u0275elementEnd()),2&r){const d=n.\u0275\u0275nextContext();n.\u0275\u0275advance(),n.\u0275\u0275property("ngForOf",d.filteredOptions)}}function a(r,e){1&r&&(n.\u0275\u0275elementStart(0,"div",5)(1,"div",11),n.\u0275\u0275text(2," No se encontraron resultados "),n.\u0275\u0275elementEnd()())}let m=(()=>{var r;class e{constructor(){this.options=[],this.placeholder="Buscar...",this.disabled=!1,this.searchTerm="",this.filteredOptions=[],this.selectedValue=null,this.showDropdown=!1,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this.filteredOptions=this.options}filterOptions(){if(!this.searchTerm||""===this.searchTerm.trim())return void(this.filteredOptions=this.options);const l=this.searchTerm.toLowerCase();this.filteredOptions=this.options.filter(_=>_.label.toLowerCase().includes(l)||_.secondaryLabel&&_.secondaryLabel.toLowerCase().includes(l))}selectOption(l){this.selectedValue=l.value,this.searchTerm=l.label,this.showDropdown=!1,this.onChange(l.value),this.onTouched()}onFocus(){this.showDropdown=!0,this.filterOptions()}onBlur(){setTimeout(()=>{this.showDropdown=!1,this.selectedValue||(this.searchTerm="")},200)}writeValue(l){if(this.selectedValue=l,l){const _=this.options.find(p=>p.value===l);_&&(this.searchTerm=_.label)}else this.searchTerm=""}registerOnChange(l){this.onChange=l}registerOnTouched(l){this.onTouched=l}setDisabledState(l){this.disabled=l}static#e=r=()=>(this.\u0275fac=function(_){return new(_||e)},this.\u0275cmp=n.\u0275\u0275defineComponent({type:e,selectors:[["app-searchable-select"]],inputs:{options:"options",placeholder:"placeholder",disabled:"disabled"},features:[n.\u0275\u0275ProvidersFeature([{provide:g.NG_VALUE_ACCESSOR,useExisting:(0,n.forwardRef)(()=>e),multi:!0}])],decls:7,vars:5,consts:[[1,"searchable-select"],[1,"search-input-wrapper"],["type","text","autocomplete","off",1,"search-input",3,"ngModelChange","focus","blur","input","placeholder","ngModel","disabled"],[1,"dropdown-icon"],["class","dropdown-list",4,"ngIf"],[1,"dropdown-list"],["class","dropdown-item",3,"selected","mousedown",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"mousedown"],[1,"option-label"],["class","option-secondary",4,"ngIf"],[1,"option-secondary"],[1,"dropdown-item","no-results"]],template:function(_,p){1&_&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"input",2),n.\u0275\u0275twoWayListener("ngModelChange",function(M){return n.\u0275\u0275twoWayBindingSet(p.searchTerm,M)||(p.searchTerm=M),M}),n.\u0275\u0275listener("focus",function(){return p.onFocus()})("blur",function(){return p.onBlur()})("input",function(){return p.filterOptions()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"span",3),n.\u0275\u0275text(4,"\u25bc"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275template(5,E,2,1,"div",4)(6,a,3,0,"div",4),n.\u0275\u0275elementEnd()),2&_&&(n.\u0275\u0275advance(2),n.\u0275\u0275property("placeholder",p.placeholder),n.\u0275\u0275twoWayProperty("ngModel",p.searchTerm),n.\u0275\u0275property("disabled",p.disabled),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",p.showDropdown&&p.filteredOptions.length>0),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",p.showDropdown&&0===p.filteredOptions.length&&p.searchTerm))},dependencies:[s.CommonModule,s.NgForOf,s.NgIf,g.FormsModule,g.DefaultValueAccessor,g.NgControlStatus,g.NgModel],styles:[".searchable-select[_ngcontent-%COMP%]{position:relative;width:100%}.search-input-wrapper[_ngcontent-%COMP%]{position:relative}.search-input[_ngcontent-%COMP%]{width:100%;padding:10px 35px 10px 12px;border:1px solid #ddd;border-radius:6px;font-size:14px;background-color:#fff;transition:all .2s;box-sizing:border-box}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2;box-shadow:0 0 0 2px #1976d21a}.search-input[_ngcontent-%COMP%]:disabled{background-color:#f5f5f5;cursor:not-allowed}.dropdown-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);pointer-events:none;color:#666;font-size:10px}.dropdown-list[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #ddd;border-radius:6px;margin-top:4px;max-height:250px;overflow-y:auto;box-shadow:0 4px 12px #00000026;z-index:1000}.dropdown-item[_ngcontent-%COMP%]{padding:10px 12px;cursor:pointer;transition:background-color .15s;border-bottom:1px solid #f0f0f0}.dropdown-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.dropdown-item.selected[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.dropdown-item.no-results[_ngcontent-%COMP%]{color:#999;cursor:default;text-align:center}.dropdown-item.no-results[_ngcontent-%COMP%]:hover{background-color:#fff}.option-label[_ngcontent-%COMP%]{font-weight:500;color:#333}.option-secondary[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-top:2px}.dropdown-item.selected[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%]{color:#1976d2}"]}))}return r(),e})()},6975:(P,y,c)=>{c.d(y,{D:()=>g});var n=c(3862),s=c(3464);let g=(()=>{var x;class b{constructor(a){this.apiService=a,this.endpoint="/accounts"}getAccounts(a,m){return this.apiService.get(this.endpoint)}getAccountById(a){return this.apiService.get(`${this.endpoint}/${a}`)}getAccountByNumber(a){return this.apiService.get(`${this.endpoint}/number/${a}`)}getAccountsByClient(a,m){return this.apiService.getPaginated(`${this.endpoint}/client/${a}`,m)}searchAccountsByNumber(a,m){return this.apiService.getPaginated(`${this.endpoint}/search`,m,{accountNumber:a})}createAccount(a){return this.apiService.post(this.endpoint,a)}updateAccount(a,m){return this.apiService.put(`${this.endpoint}/${a}`,m)}updateAccountStatus(a,m){return this.apiService.patch(`${this.endpoint}/${a}/status`,{status:m})}deleteAccount(a){return this.apiService.delete(`${this.endpoint}/${a}`)}checkAccountNumberExists(a,m){const r=m?{excludeId:m.toString()}:{};return this.apiService.get(`${this.endpoint}/check-number/${a}`,r)}getAccountBalance(a){return this.apiService.get(`${this.endpoint}/${a}/balance`)}getAccountStats(){return this.apiService.get(`${this.endpoint}/stats`)}getAccountStatsByClient(a){return this.apiService.get(`${this.endpoint}/stats/client/${a}`)}static#e=x=()=>(this.\u0275fac=function(m){return new(m||b)(n.\u0275\u0275inject(s.G))},this.\u0275prov=n.\u0275\u0275defineInjectable({token:b,factory:b.\u0275fac,providedIn:"root"}))}return x(),b})()},9769:(P,y,c)=>{c.r(y),c.d(y,{AccountsPageComponent:()=>N});var n=c(9544),s=c(4358),g=c(2425),x=c(8219),b=c(1573),E=c(5417),a=c(2021),m=function(u){return u.SAVINGS="SAVINGS",u.CHECKING="CHECKING",u}(m||{});const r={[m.SAVINGS]:"Ahorros",[m.CHECKING]:"Corriente"};var e=c(3862),d=c(6975),l=c(9999),_=c(5567);function p(u,C){1&u&&(e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275text(1," \u26a0\ufe0f Este n\xfamero de cuenta ya est\xe1 registrado en el sistema. Por favor use otro n\xfamero. "),e.\u0275\u0275elementEnd())}function S(u,C){if(1&u&&(e.\u0275\u0275elementStart(0,"option",32),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&u){const f=C.$implicit;e.\u0275\u0275property("value",f.value),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",f.label," ")}}function M(u,C){if(1&u&&(e.\u0275\u0275elementStart(0,"div",33),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&u){const f=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",f.getFieldError("accountType")," ")}}function A(u,C){if(1&u&&(e.\u0275\u0275elementStart(0,"div",33),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&u){const f=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",f.getFieldError("status")," ")}}function T(u,C){if(1&u&&(e.\u0275\u0275elementStart(0,"div",33),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&u){const f=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",f.getFieldError("clientId")," ")}}function I(u,C){if(1&u){const f=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(f);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.closeModal())}),e.\u0275\u0275elementStart(1,"div",10),e.\u0275\u0275listener("click",function(o){return e.\u0275\u0275restoreView(f),e.\u0275\u0275resetView(o.stopPropagation())}),e.\u0275\u0275elementStart(2,"div",11)(3,"h2",12),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(f);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.closeModal())}),e.\u0275\u0275text(6,"\xd7"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"form",14),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(f);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onSubmit())}),e.\u0275\u0275elementStart(8,"div",15),e.\u0275\u0275element(9,"app-input",16),e.\u0275\u0275template(10,p,2,0,"div",17),e.\u0275\u0275elementStart(11,"div",18)(12,"label",19),e.\u0275\u0275text(13,"Tipo de Cuenta"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"select",20)(15,"option",21),e.\u0275\u0275text(16,"Seleccionar tipo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(17,S,2,2,"option",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,M,2,1,"div",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(19,"app-input",24),e.\u0275\u0275elementStart(20,"div",18)(21,"label",19),e.\u0275\u0275text(22,"Estado"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"select",25)(24,"option",26),e.\u0275\u0275text(25,"Activo (S\xed)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"option",26),e.\u0275\u0275text(27,"Inactivo (No)"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(28,A,2,1,"div",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"div",18)(30,"label",19),e.\u0275\u0275text(31,"Cliente"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(32,"app-searchable-select",27),e.\u0275\u0275template(33,T,2,1,"div",23),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(34,"div",28)(35,"app-button",29),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(f);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.closeModal())}),e.\u0275\u0275text(36," Cancelar "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"app-button",30),e.\u0275\u0275text(38),e.\u0275\u0275elementEnd()()()()()}if(2&u){let f;const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",t.isEditing?"Editar Cuenta":"Nueva Cuenta"," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.accountForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("accountNumber")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==(f=t.accountForm.get("accountNumber"))?null:f.hasError("accountNumberTaken")),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",t.accountTypeOptions),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",t.getFieldError("accountType")),e.\u0275\u0275advance(),e.\u0275\u0275property("required",!0)("errorMessage",t.getFieldError("initialBalance")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngValue",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngValue",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.getFieldError("status")),e.\u0275\u0275advance(4),e.\u0275\u0275property("options",t.clientOptions),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",t.getFieldError("clientId")),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",t.accountForm.invalid||t.accountForm.pending||t.loading),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",t.isEditing?"Actualizar":"Crear"," ")}}let N=(()=>{var u;class C{constructor(t,o,i,h){this.accountService=t,this.clientService=o,this.notificationService=i,this.fb=h,this.accounts=[],this.filteredAccounts=[],this.clients=[],this.clientOptions=[],this.searchTerm="",this.showModal=!1,this.isEditing=!1,this.loading=!1,this.currentAccount=null,this.pageSize=10,this.totalItems=0,this.tableColumns=[{key:"accountNumber",label:"N\xfamero de Cuenta",sortable:!0},{key:"accountType",label:"Tipo",sortable:!0},{key:"initialBalance",label:"Saldo Inicial",sortable:!0,type:"currency"},{key:"clientName",label:"Cliente",sortable:!0},{key:"status",label:"Estado",sortable:!0,type:"boolean"}],this.tableActions=[{label:"Editar",action:"edit",variant:"primary"},{label:"Eliminar",action:"delete",variant:"danger"}],this.accountTypeOptions=Object.entries(r).map(([v,w])=>({value:v,label:w})),this.destroy$=new g.Subject,this.accountForm=this.createForm()}ngOnInit(){this.loadClients()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}createForm(){return this.fb.group({accountNumber:["",[s.Validators.required,s.Validators.pattern(/^\d{6}$/)],[this.uniqueAccountNumberValidator()]],accountType:["",s.Validators.required],initialBalance:["",[s.Validators.required,s.Validators.min(0)]],clientId:["",s.Validators.required],status:[!0,s.Validators.required]})}loadAccounts(){this.loading=!0,this.accountService.getAccounts().pipe((0,g.takeUntil)(this.destroy$)).subscribe({next:t=>{this.accounts=t.map(o=>{const i=this.clients.find(h=>h.clientId===o.clientId);return{...o,clientName:i?.name||o.client?.name||"N/A"}}),this.filteredAccounts=this.accounts,this.totalItems=t.length,this.loading=!1},error:t=>{console.error("Error cargando cuentas:",t),this.notificationService.showError("Error","No se pudieron cargar las cuentas: "+t.message),this.loading=!1}})}loadClients(){this.clientService.getClients().pipe((0,g.takeUntil)(this.destroy$)).subscribe({next:t=>{this.clients=t,this.clientOptions=t.map(o=>({value:o.clientId,label:o.name,secondaryLabel:`ID: ${o.identification}`})),this.loadAccounts()},error:t=>{console.error("Error cargando clientes:",t),this.notificationService.showError("Error","No se pudieron cargar los clientes")}})}onSearchChange(t){this.searchTerm=t.target.value,this.filterAccounts()}filterAccounts(){if(!this.searchTerm||""===this.searchTerm.trim())return void(this.filteredAccounts=this.accounts);const t=this.searchTerm.toLowerCase();this.filteredAccounts=this.accounts.filter(o=>o.accountNumber.toLowerCase().includes(t)||o.clientName&&o.clientName.toLowerCase().includes(t)||"SAVINGS"===o.accountType&&"ahorros".includes(t)||"CHECKING"===o.accountType&&"corriente".includes(t))}openCreateModal(){this.isEditing=!1,this.currentAccount=null,this.accountForm.reset(),this.accountForm.get("status")?.setValue(!0),this.accountForm.get("accountNumber")?.updateValueAndValidity(),this.showModal=!0}openEditModal(t){this.isEditing=!0,this.currentAccount=t,this.accountForm.patchValue({accountNumber:t.accountNumber,accountType:t.accountType,initialBalance:t.initialBalance,clientId:t.clientId,status:t.status}),this.accountForm.get("accountNumber")?.updateValueAndValidity(),this.showModal=!0}closeModal(){this.showModal=!1,this.isEditing=!1,this.currentAccount=null,this.accountForm.reset()}onSubmit(){if(this.accountForm.valid){this.loading=!0;const t=this.accountForm.value;this.isEditing&&this.currentAccount?this.accountService.updateAccount(this.currentAccount.id||this.currentAccount.accountId,{accountNumber:t.accountNumber,accountType:t.accountType,initialBalance:t.initialBalance,status:!0===t.status,clientId:t.clientId}).pipe((0,g.takeUntil)(this.destroy$)).subscribe({next:()=>{this.notificationService.showSuccess("\xc9xito","Cuenta actualizada correctamente"),this.closeModal(),this.loadAccounts()},error:i=>{console.error("Error al actualizar cuenta:",i);let h="No se pudo actualizar la cuenta";(i.message&&(i.message.includes("ya existe")||i.message.includes("duplicate")||i.message.includes("already exists")||i.message.includes("Conflicto"))||409===i.status)&&(h=`El n\xfamero de cuenta ${t.accountNumber} ya existe. Por favor, use otro n\xfamero de cuenta.`),this.notificationService.showError("Error",h),this.loading=!1}}):this.accountService.createAccount({accountNumber:t.accountNumber,accountType:t.accountType,initialBalance:t.initialBalance,clientId:t.clientId,status:!0===t.status}).pipe((0,g.takeUntil)(this.destroy$)).subscribe({next:()=>{this.notificationService.showSuccess("\xc9xito","Cuenta creada correctamente"),this.closeModal(),this.loadAccounts()},error:i=>{console.error("Error al crear cuenta:",i);let h="No se pudo crear la cuenta";(i.message&&(i.message.includes("ya existe")||i.message.includes("duplicate")||i.message.includes("already exists")||i.message.includes("Conflicto"))||409===i.status)&&(h=`El n\xfamero de cuenta ${t.accountNumber} ya existe. Por favor, use otro n\xfamero de cuenta.`),this.notificationService.showError("Error",h),this.loading=!1}})}}onTableAction(t){switch(t.action){case"edit":this.openEditModal(t.row);break;case"delete":this.deleteAccount(t.row)}}deleteAccount(t){confirm(`\xbfEst\xe1 seguro de que desea eliminar la cuenta ${t.accountNumber}?`)&&(this.loading=!0,this.accountService.deleteAccount(t.id||t.accountId).pipe((0,g.takeUntil)(this.destroy$)).subscribe({next:()=>{this.notificationService.showSuccess("\xc9xito","Cuenta eliminada correctamente"),this.loadAccounts()},error:o=>{this.notificationService.showError("Error","No se pudo eliminar la cuenta"),this.loading=!1}}))}onSortChange(t){}getFieldError(t){const o=this.accountForm.get(t);if(o?.errors&&o.touched){if(o.errors.required)return"Este campo es requerido";if(o.errors.pattern)return"accountNumber"===t?"Debe tener exactamente 6 d\xedgitos num\xe9ricos":"Formato inv\xe1lido";if(o.errors.min)return`Valor m\xednimo: ${o.errors.min.min}`;if(o.errors.accountNumberTaken)return"Este n\xfamero de cuenta ya existe"}return""}uniqueAccountNumberValidator(){return t=>{const o=t.value;if(!o||!/^\d{6}$/.test(o))return Promise.resolve(null);const i=this.isEditing&&this.currentAccount?this.currentAccount.id||this.currentAccount.accountId:void 0,h=this.accounts.some(v=>v.accountNumber===o&&(v.id||v.accountId)!==i);return h?Promise.resolve({accountNumberTaken:!0}):this.accountService.checkAccountNumberExists(o,i).pipe(v=>new Promise(w=>{v.subscribe({next:O=>{w(O?{accountNumberTaken:!0}:null)},error:()=>{w(h?{accountNumberTaken:!0}:null)}})}))}}static#e=u=()=>(this.\u0275fac=function(o){return new(o||C)(e.\u0275\u0275directiveInject(d.D),e.\u0275\u0275directiveInject(l.X),e.\u0275\u0275directiveInject(_.J),e.\u0275\u0275directiveInject(s.FormBuilder))},this.\u0275cmp=e.\u0275\u0275defineComponent({type:C,selectors:[["app-accounts-page"]],decls:11,vars:7,consts:[[1,"accounts-page"],[1,"page-header"],[1,"page-title"],[1,"page-actions"],["type","primary",3,"clicked"],[1,"search-section"],["placeholder","Buscar",3,"ngModelChange","input","ngModel"],[3,"actionClick","sortChange","data","columns","actions","showPagination","pageSize"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-close",3,"click"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"form-grid"],["label","N\xfamero de Cuenta (6 d\xedgitos)","formControlName","accountNumber",3,"required","errorMessage"],["class","duplicate-warning",4,"ngIf"],[1,"form-group"],[1,"form-label"],["formControlName","accountType",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","error-message",4,"ngIf"],["label","Saldo Inicial","type","number","formControlName","initialBalance",3,"required","errorMessage"],["formControlName","status",1,"form-select"],[3,"ngValue"],["formControlName","clientId","placeholder","Buscar cliente...",3,"options"],[1,"modal-footer"],["htmlType","button","type","secondary",3,"clicked"],["htmlType","submit","type","primary",3,"disabled"],[1,"duplicate-warning"],[3,"value"],[1,"error-message"]],template:function(o,i){1&o&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"h1",2),e.\u0275\u0275text(3,"Cuentas"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",3)(5,"app-button",4),e.\u0275\u0275listener("clicked",function(){return i.openCreateModal()}),e.\u0275\u0275text(6," Nuevo "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"div",5)(8,"app-input",6),e.\u0275\u0275twoWayListener("ngModelChange",function(v){return e.\u0275\u0275twoWayBindingSet(i.searchTerm,v)||(i.searchTerm=v),v}),e.\u0275\u0275listener("input",function(v){return i.onSearchChange(v)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"app-table",7),e.\u0275\u0275listener("actionClick",function(v){return i.onTableAction(v)})("sortChange",function(v){return i.onSortChange(v)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,I,39,16,"div",8),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(8),e.\u0275\u0275twoWayProperty("ngModel",i.searchTerm),e.\u0275\u0275advance(),e.\u0275\u0275property("data",i.filteredAccounts)("columns",i.tableColumns)("actions",i.tableActions)("showPagination",!0)("pageSize",i.pageSize),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.showModal))},dependencies:[n.CommonModule,n.NgForOf,n.NgIf,s.ReactiveFormsModule,s.\u0275NgNoValidate,s.NgSelectOption,s.\u0275NgSelectMultipleOption,s.SelectControlValueAccessor,s.NgControlStatus,s.NgControlStatusGroup,s.RequiredValidator,s.FormGroupDirective,s.FormControlName,s.FormsModule,s.NgModel,x.Q,b.S,E.O,a.w],styles:['@charset "UTF-8";.accounts-page[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:var(--spacing-6)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-6);padding-bottom:var(--spacing-4);border-bottom:1px solid var(--gray-200)}.page-title[_ngcontent-%COMP%]{font-size:var(--font-size-3xl);font-weight:600;color:var(--gray-800);margin:0}.page-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-3)}.search-section[_ngcontent-%COMP%]{margin-bottom:var(--spacing-6);max-width:400px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:var(--spacing-4)}.modal-content[_ngcontent-%COMP%]{background-color:var(--white);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-lg);width:100%;max-width:600px;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-6);border-bottom:1px solid var(--gray-200)}.modal-title[_ngcontent-%COMP%]{font-size:var(--font-size-xl);font-weight:600;color:var(--gray-800);margin:0}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:var(--font-size-2xl);color:var(--gray-500);cursor:pointer;padding:var(--spacing-2);line-height:1;transition:color .2s ease}.modal-close[_ngcontent-%COMP%]:hover{color:var(--gray-700)}.modal-body[_ngcontent-%COMP%]{padding:var(--spacing-6)}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:var(--spacing-3);padding:var(--spacing-6);border-top:1px solid var(--gray-200);background-color:var(--gray-50)}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:var(--spacing-4)}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-2)}.form-label[_ngcontent-%COMP%]{font-size:var(--font-size-sm);font-weight:500;color:var(--gray-700)}.form-select[_ngcontent-%COMP%]{padding:var(--spacing-3) var(--spacing-4);border:1px solid var(--gray-300);border-radius:var(--border-radius-md);background-color:var(--white);color:var(--gray-800);font-family:var(--font-family);font-size:var(--font-size-base);transition:all .2s ease;outline:none}.form-select[_ngcontent-%COMP%]:focus{border-color:var(--primary-color);box-shadow:0 0 0 2px #3b82f61a}.form-select[_ngcontent-%COMP%]:invalid{color:var(--gray-400)}.error-message[_ngcontent-%COMP%]{font-size:var(--font-size-xs);color:var(--error-color);margin-top:var(--spacing-1)}.duplicate-warning[_ngcontent-%COMP%]{grid-column:1/-1;background-color:#ef44441a;border:1px solid var(--error-color);border-left:4px solid var(--error-color);color:var(--error-color);padding:var(--spacing-3);border-radius:var(--border-radius-md);font-size:var(--font-size-sm);font-weight:600;margin-top:calc(var(--spacing-2) * -1);margin-bottom:var(--spacing-3);text-align:center}@media (max-width: 768px){.accounts-page[_ngcontent-%COMP%]{padding:var(--spacing-4)}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:var(--spacing-4);align-items:stretch}.page-actions[_ngcontent-%COMP%]{justify-content:center}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-content[_ngcontent-%COMP%]{margin:var(--spacing-4);max-height:calc(100vh - 2rem)}.modal-header[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{padding:var(--spacing-4)}.modal-footer[_ngcontent-%COMP%]{flex-direction:column}}@media (max-width: 480px){.accounts-page[_ngcontent-%COMP%]{padding:var(--spacing-3)}.page-title[_ngcontent-%COMP%]{font-size:var(--font-size-2xl)}.modal-content[_ngcontent-%COMP%]{margin:var(--spacing-2);max-height:calc(100vh - 1rem)}}']}))}return u(),C})()},9999:(P,y,c)=>{c.d(y,{X:()=>b});var n=c(467),s=c(2425),g=c(3862),x=c(3464);let b=(()=>{var E;class a{constructor(r){this.apiService=r,this.endpoint="/clients"}getClients(r,e){return this.apiService.get(this.endpoint)}getClientById(r){return this.apiService.get(`${this.endpoint}/${r}`)}getClientByIdentification(r){return this.apiService.get(`${this.endpoint}/identification/${r}`)}searchClientsByName(r,e){return this.apiService.getPaginated(`${this.endpoint}/search`,e,{name:r})}createClient(r){return(0,s.from)(this.hashSha256Hex(r.password)).pipe((0,s.switchMap)(e=>{const d={...r,password:e};return this.apiService.post(this.endpoint,d)}))}updateClient(r,e){const d={...e};return e.password?(0,s.from)(this.hashSha256Hex(e.password)).pipe((0,s.switchMap)(l=>(d.password=l,this.apiService.put(`${this.endpoint}/${r}`,d)))):this.apiService.put(`${this.endpoint}/${r}`,d)}updateClientStatus(r,e){return this.apiService.patch(`${this.endpoint}/${r}/status`,{status:e})}deleteClient(r){return this.apiService.delete(`${this.endpoint}/${r}`)}checkIdentificationExists(r,e){const d=e?{excludeId:e.toString()}:{};return this.apiService.get(`${this.endpoint}/check-identification/${r}`,d)}checkNameExists(r,e){const d=e?{excludeId:e.toString()}:{};return this.apiService.get(`${this.endpoint}/check-name/${r}`,d)}getClientStats(){return this.apiService.get(`${this.endpoint}/stats`)}hashSha256Hex(r){return(0,n.A)(function*(){const d=(new TextEncoder).encode(r),l=yield crypto.subtle.digest("SHA-256",d);return Array.from(new Uint8Array(l)).map(S=>S.toString(16).padStart(2,"0")).join("")})()}static#e=E=()=>(this.\u0275fac=function(e){return new(e||a)(g.\u0275\u0275inject(x.G))},this.\u0275prov=g.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"}))}return E(),a})()}}]);